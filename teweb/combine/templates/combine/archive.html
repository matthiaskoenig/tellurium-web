{% extends "combine/base_generic.html" %}
{% load static %}

{% block content %}
<h1><a href="http://co.mbine.org/documents/archive" alt="COMBINE archive format" target="_blank"><img
            src="{% static 'combine/images/logos/omex.png' %}" height="40"></a> {{ archive }}</h1>

<ul>
    {% for entry in entries %}
    <li>{{ entry }}<b><code>{{entry.getLocation }}</code></b> ({{entry.getFormat}})</li>
    {% endfor %}
</ul>

<hr />
<h2>Results</h2>
<p>
<i class="fa fa-spinner fa-pulse fa-2x fa-fw"></i>
<span class="sr-only">Loading...</span>
Executing <b><code>{{ archive }}</code></b>
</p>

<p>
<input type="button" id="buttonid" value="status">
<b>Task:</b> {{ task_id }}
</p>

   <!--
   <div class="progress_container">

   <div class="current-task">
    <b>{% if task_id %} Task ID: {{ task_id }} {% endif %}</b>
   </div>



   <div class="status"></div>

   <div class="progress">

        <div class="bar"></div>
        </div>
  </div>
   -->

 </div>


{% endblock %}

{% block javascript %}
  <script>
  var button = document.getElementById("buttonid");
  button.addEventListener("click", function() {
      console.log("Hello world");
      console.log("call");
  });

  /*
    var csrftoken = getCookie('csrftoken');
   var poll_xhr;
   var willstop = 0;
  (function(){
    var poll = function(){
      var json_dump = "";
      var task_id = "{{ task_id }}";

      console.log(task_id);
      poll_xhr = $.ajax({
        url:'check_state',
        type: 'POST',
        data: {
            task_id: task_id,
            csrfmiddlewaretoken: csrftoken,
        },
        success: function(result) {
                    if (result.process_percent == null || result.process_percent == undefined) {
                        willstop = 1;
                        document.getElementById("user-count").textContent="DONE";
                        jQuery('.bar').css({'width': 100 + '%'});
                        jQuery('.bar').html(100 + '%');
                        document.getElementById('returnBtn').style.visibility = 'visible';

                       } else {
                         jQuery('.bar').css({'width': result.process_percent + '%'});
                         jQuery('.bar').html(result.process_percent + '%');
                         document.getElementById("user-count").textContent="PROCRESSING";
                       };
                    }
      });
    };

    var refreshIntervalId = setInterval(function() {
      poll();
      if(willstop == 1){
        clearInterval(refreshIntervalId);
      }
    },500);


  })();
  */
  </script>
{% endblock %}


