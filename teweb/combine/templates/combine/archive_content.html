<div class="col-lg-6">
    <div class="panel panel-default">
        <div class="panel-heading">

            <h2 class="panel-title">
                <a class="btn-xs btn-default" href="{{ url('combine:archive_previous', args=[archive.id]) }}"
                   title="Previous archive"><i class="fa fa-arrow-circle-o-left fa-fw"></i></a>
                <a class="btn-xs btn-default" href="{{ url('combine:archive_next', args=[archive.id]) }}"
                   title="Next archive"><i class="fa fa-arrow-circle-o-right fa-fw"></i></a>

                <i class="fa fa-archive fa-fw"></i>
                <a href="{{ url('combine:archive', args=[archive.id]) }}">
                    <span class="label label-primary"><span class="badge">{{ archive.id }}</span> {{ archive }}</span></a>
                (<a href="{{ url('combine:download_archive', args=[archive.id]) }}" title="Download archive"><i class="fa fa-download fa-fw"></i></a>)
            </h2>

        </div>

        <div class="panel-body">
            {% if entries %}
                <table id="entries" class="table table-striped table-condensed table-hover">
                    <thead>
                    <tr>
                        <th></th>
                        <th></th>
                        <th>format</th>
                        <th>location</th>
                        <th class="hidden-xs">metadata</th>
                    </tr>
                    </thead>
                    {% for entry in entries %}
                        <tr>
                            <td><span class="badge">{{ loop.index }}</span></td>
                            <td>{% if entry.master %}
                                <i class="fa fa-star fa-fw" title="master"></i>
                            {% endif %}
                            </td>
                            <td>
                                {% if entry.short_format in ['cellml', 'sed-ml', 'sbml', 'sbgn', 'omex-manifest'] %}
                                    <img height=20 title="{{ entry.format }}"
                                         src="{{ static('combine/images/mediatype/')}}{{ entry.short_format }}.png">
                                {% else %}
                                    <code title="{{ entry.format }}">{{ entry.short_format }}</code>
                                {% endif %}
                            </td>
                            <td>
                                <a href="{{ url('combine:archive_entry', args=[archive.id, loop.index0]) }}"
                                   target="_blank">{{ entry.location }}</a>
                            </td>

                            <td class="hidden-xs">
                                {% if entry.metadata %}
                                {% with md = entry.metadata %}

                                 <span data-toggle="popover"
                                       data-html="true"
                                       class="btn-xs btn-default"
                                       title="{% for creator in md.creators %}
                                                <b>{{ creator.givenName }} {{ creator.familyName }}</b>
                                                {% if creator.organisation %}
                                                ({{ creator.organisation }})
                                                {%  endif %}<br/>
                                               {% endfor %}"
                                       data-content="{% if md.created %}
                                                        <b>created</b><br />
                                                        <code>{{ md.created }}</code><br />
                                                     {%  endif %}
                                                     {%  if md.modified %}
                                                     <b>modified</b><br />
                                                     {%  endif %}
                                                        {% for mod in md.modified %}
                                                            <code>{{ mod }}</code><br/>
                                                        {% endfor %}"> <i class="fa fa-plus-square-o fa-fw" title="metadata"></i></span>
                                    {% endwith %}
                                {% endif %}

                                {% if entry.metadata %}
                                    {% with md = entry.metadata %}
                                        {{ md.description }}
                                    {% endwith %}
                                {% endif %}
                            </td>

                        </tr>
                    {% endfor %}
                </table>
            {% else %}
                <p>No entries in archive metadata.</p>
            {% endif %}

            <h3>Files</h3>
            <div id="json_tree"></div>
            <script>
                $(function () {
                    $('#json_tree').jstree({ 'core' : {
                        'data' : JSON.parse('{{ tree_data_json|safe }}')
                    } });
                });
            </script>

        </div>
    </div>
</div>
